// Internationalization (i18n) System
// Translations for Spanish, English, and Portuguese

const translations = {
    es: {
        // Navigation
        'nav-features': 'Caracter√≠sticas',
        'nav-how-it-works': 'C√≥mo Funciona',
        'nav-download': 'Descargar',

        // Hero Section
        'hero-badge': 'Para Albion Online',
        'hero-title-1': 'Domina el Combate con',
        'hero-description': 'El medidor de DPS m√°s avanzado para Albion Online. Rastrea el da√±o en tiempo real, analiza el rendimiento de tu party y mejora tu estrategia de combate.',
        'hero-acknowledgment': 'Un agradecimiento especial a <strong>Triky313</strong>, gracias a el este programa es posible.',
        'hero-btn-download': 'Descargar Gratis',
        'hero-btn-version-label': 'versi√≥n actual',
        'hero-btn-discord': 'Comunidad Discord',
        'hero-btn-features': 'Ver Caracter√≠sticas',
        'hero-stat-free': 'Gratis',
        'hero-stat-realtime': 'Real-Time',
        'hero-stat-realtime-label': 'Datos en Vivo',
        'hero-stat-light': 'Ligero',
        'hero-stat-light-label': 'Sin Lag',

        // Features Section
        'features-title': 'Caracter√≠sticas Principales',
        'features-description': 'Todo lo que necesitas para dominar el combate en Albion Online',
        'feature-1-title': 'Estad√≠sticas en Tiempo Real',
        'feature-1-desc': 'Visualiza el DPS de cada miembro de tu party instant√°neamente durante el combate.',
        'feature-2-title': 'Interfaz Intuitiva',
        'feature-2-desc': 'Dise√±o limpio y f√°cil de usar que no interfiere con tu experiencia de juego.',
        'feature-3-title': 'Ultra Ligero',
        'feature-3-desc': 'Optimizado para no afectar el rendimiento del juego, consume m√≠nimos recursos.',
        'feature-4-title': 'Copia R√°pida',
        'feature-4-desc': 'Copia las estad√≠sticas al portapapeles con un solo clic para compartir con tu guild.',
        'feature-5-title': 'Siempre Visible',
        'feature-5-desc': 'Modo "Always On Top" para mantener las estad√≠sticas visibles sobre el juego.',
        'feature-6-title': 'Personalizable',
        'feature-6-desc': 'Ajusta la interfaz a tu gusto con opciones de personalizaci√≥n flexibles.',

        // How It Works Section
        'how-it-works-title': 'C√≥mo Funciona',
        'how-it-works-description': 'Comienza a usar HCE DPS Metter en 3 simples pasos',
        'step-1-title': 'Descarga e Instala',
        'step-1-desc': 'Descarga el programa y extrae los archivos en tu carpeta preferida.',
        'step-2-title': 'Ejecuta el Programa',
        'step-2-desc': 'Abre HCE DPS Metter antes o durante tu sesi√≥n de Albion Online.',
        'step-3-title': '¬°Listo para Combatir!',
        'step-3-desc': 'Las estad√≠sticas de DPS aparecer√°n autom√°ticamente durante el combate.',
        'video-title': 'üì∫ Video Tutorial Completo',
        'video-description': 'Mira este video para ver el programa en acci√≥n y aprender a usarlo paso a paso.',

        // Download Section
        'download-title': 'Descarga HCE DPS Metter',
        'download-description': 'Versi√≥n 1.0.0 - Compatible con Windows 10/11',
        'download-feature-1': '100% Gratis y Open Source',
        'download-feature-2': 'Sin anuncios ni malware',
        'download-feature-3': 'Actualizaciones regulares',
        'download-btn': 'Descargar Ahora',
        'download-btn-sub': 'Windows 10/11',
        'download-note': 'Al descargar, aceptas que este es un proyecto de c√≥digo abierto sin garant√≠as.',

        // Footer
        'footer-description': 'Medidor de DPS para Albion Online desarrollado por la comunidad.',
        'footer-product': 'Producto',
        'footer-support': 'Soporte',
        'footer-documentation': 'Documentaci√≥n',
        'footer-report-bug': 'Reportar Bug',
        'footer-contact': 'Contacto',
        'footer-copyright': '¬© 2026 HCE DPS Metter. Proyecto de c√≥digo abierto para la comunidad de Albion Online.'
    },

    en: {
        // Navigation
        'nav-features': 'Features',
        'nav-how-it-works': 'How It Works',
        'nav-download': 'Download',

        // Hero Section
        'hero-badge': 'For Albion Online',
        'hero-title-1': 'Master Combat with',
        'hero-description': 'The most advanced DPS meter for Albion Online. Track damage in real-time, analyze your party\'s performance and improve your combat strategy.',
        'hero-acknowledgment': 'Special thanks to <strong>Triky313</strong>, thanks to him this program is possible.',
        'hero-btn-download': 'Download Free',
        'hero-btn-version-label': 'current version',
        'hero-btn-discord': 'Discord Community',
        'hero-btn-features': 'View Features',
        'hero-stat-free': 'Free',
        'hero-stat-realtime': 'Real-Time',
        'hero-stat-realtime-label': 'Live Data',
        'hero-stat-light': 'Lightweight',
        'hero-stat-light-label': 'No Lag',

        // Features Section
        'features-title': 'Main Features',
        'features-description': 'Everything you need to dominate combat in Albion Online',
        'feature-1-title': 'Real-Time Statistics',
        'feature-1-desc': 'View each party member\'s DPS instantly during combat.',
        'feature-2-title': 'Intuitive Interface',
        'feature-2-desc': 'Clean and easy-to-use design that doesn\'t interfere with your gaming experience.',
        'feature-3-title': 'Ultra Lightweight',
        'feature-3-desc': 'Optimized to not affect game performance, uses minimal resources.',
        'feature-4-title': 'Quick Copy',
        'feature-4-desc': 'Copy statistics to clipboard with one click to share with your guild.',
        'feature-5-title': 'Always Visible',
        'feature-5-desc': '"Always On Top" mode to keep statistics visible over the game.',
        'feature-6-title': 'Customizable',
        'feature-6-desc': 'Adjust the interface to your liking with flexible customization options.',

        // How It Works Section
        'how-it-works-title': 'How It Works',
        'how-it-works-description': 'Start using HCE DPS Metter in 3 simple steps',
        'step-1-title': 'Download & Install',
        'step-1-desc': 'Download the program and extract the files to your preferred folder.',
        'step-2-title': 'Run the Program',
        'step-2-desc': 'Open HCE DPS Metter before or during your Albion Online session.',
        'step-3-title': 'Ready to Fight!',
        'step-3-desc': 'DPS statistics will appear automatically during combat.',
        'video-title': 'üì∫ Complete Video Tutorial',
        'video-description': 'Watch this video to see the program in action and learn how to use it step by step.',

        // Download Section
        'download-title': 'Download HCE DPS Metter',
        'download-description': 'Version 1.0.0 - Compatible with Windows 10/11',
        'download-feature-1': '100% Free and Open Source',
        'download-feature-2': 'No ads or malware',
        'download-feature-3': 'Regular updates',
        'download-btn': 'Download Now',
        'download-btn-sub': 'Windows 10/11',
        'download-note': 'By downloading, you accept that this is an open source project without warranties.',

        // Footer
        'footer-description': 'DPS meter for Albion Online developed by the community.',
        'footer-product': 'Product',
        'footer-support': 'Support',
        'footer-documentation': 'Documentation',
        'footer-report-bug': 'Report Bug',
        'footer-contact': 'Contact',
        'footer-copyright': '¬© 2026 HCE DPS Metter. Open source project for the Albion Online community.'
    },

    pt: {
        // Navigation
        'nav-features': 'Caracter√≠sticas',
        'nav-how-it-works': 'Como Funciona',
        'nav-download': 'Baixar',

        // Hero Section
        'hero-badge': 'Para Albion Online',
        'hero-title-1': 'Domine o Combate com',
        'hero-description': 'O medidor de DPS mais avan√ßado para Albion Online. Rastreie o dano em tempo real, analise o desempenho do seu grupo e melhore sua estrat√©gia de combate.',
        'hero-acknowledgment': 'Um agradecimento especial a <strong>Triky313</strong>, gra√ßas a ele este programa √© poss√≠vel.',
        'hero-btn-download': 'Baixar Gr√°tis',
        'hero-btn-version-label': 'vers√£o atual',
        'hero-btn-discord': 'Comunidade Discord',
        'hero-btn-features': 'Ver Caracter√≠sticas',
        'hero-stat-free': 'Gr√°tis',
        'hero-stat-realtime': 'Tempo Real',
        'hero-stat-realtime-label': 'Dados ao Vivo',
        'hero-stat-light': 'Leve',
        'hero-stat-light-label': 'Sem Lag',

        // Features Section
        'features-title': 'Principais Caracter√≠sticas',
        'features-description': 'Tudo o que voc√™ precisa para dominar o combate em Albion Online',
        'feature-1-title': 'Estat√≠sticas em Tempo Real',
        'feature-1-desc': 'Visualize o DPS de cada membro do grupo instantaneamente durante o combate.',
        'feature-2-title': 'Interface Intuitiva',
        'feature-2-desc': 'Design limpo e f√°cil de usar que n√£o interfere na sua experi√™ncia de jogo.',
        'feature-3-title': 'Ultra Leve',
        'feature-3-desc': 'Otimizado para n√£o afetar o desempenho do jogo, consome recursos m√≠nimos.',
        'feature-4-title': 'C√≥pia R√°pida',
        'feature-4-desc': 'Copie as estat√≠sticas para a √°rea de transfer√™ncia com um clique para compartilhar com sua guilda.',
        'feature-5-title': 'Sempre Vis√≠vel',
        'feature-5-desc': 'Modo "Always On Top" para manter as estat√≠sticas vis√≠veis sobre o jogo.',
        'feature-6-title': 'Personaliz√°vel',
        'feature-6-desc': 'Ajuste a interface ao seu gosto com op√ß√µes de personaliza√ß√£o flex√≠veis.',

        // How It Works Section
        'how-it-works-title': 'Como Funciona',
        'how-it-works-description': 'Comece a usar HCE DPS Metter em 3 passos simples',
        'step-1-title': 'Baixe e Instale',
        'step-1-desc': 'Baixe o programa e extraia os arquivos para sua pasta preferida.',
        'step-2-title': 'Execute o Programa',
        'step-2-desc': 'Abra HCE DPS Metter antes ou durante sua sess√£o de Albion Online.',
        'step-3-title': 'Pronto para Lutar!',
        'step-3-desc': 'As estat√≠sticas de DPS aparecer√£o automaticamente durante o combate.',
        'video-title': 'üì∫ Tutorial em V√≠deo Completo',
        'video-description': 'Assista a este v√≠deo para ver o programa em a√ß√£o e aprender a us√°-lo passo a passo.',

        // Download Section
        'download-title': 'Baixar HCE DPS Metter',
        'download-description': 'Vers√£o 1.0.0 - Compat√≠vel com Windows 10/11',
        'download-feature-1': '100% Gr√°tis e Open Source',
        'download-feature-2': 'Sem an√∫ncios ou malware',
        'download-feature-3': 'Atualiza√ß√µes regulares',
        'download-btn': 'Baixar Agora',
        'download-btn-sub': 'Windows 10/11',
        'download-note': 'Ao baixar, voc√™ aceita que este √© um projeto de c√≥digo aberto sem garantias.',

        // Footer
        'footer-description': 'Medidor de DPS para Albion Online desenvolvido pela comunidade.',
        'footer-product': 'Produto',
        'footer-support': 'Suporte',
        'footer-documentation': 'Documenta√ß√£o',
        'footer-report-bug': 'Reportar Bug',
        'footer-contact': 'Contato',
        'footer-copyright': '¬© 2026 HCE DPS Metter. Projeto de c√≥digo aberto para a comunidade de Albion Online.'
    }
};

// Language Manager
class LanguageManager {
    constructor() {
        this.currentLang = localStorage.getItem('language') || 'es';
        this.init();
    }

    init() {
        // Set initial language
        this.setLanguage(this.currentLang, false);

        // Setup event listeners
        this.setupEventListeners();
    }

    setupEventListeners() {
        const languageBtn = document.getElementById('languageBtn');
        const languageDropdown = document.getElementById('languageDropdown');
        const languageOptions = document.querySelectorAll('.language-option');

        // Toggle dropdown
        languageBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            languageDropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
            languageDropdown.classList.remove('show');
        });

        // Language selection
        languageOptions.forEach(option => {
            option.addEventListener('click', (e) => {
                e.stopPropagation();
                const lang = option.getAttribute('data-lang');
                this.setLanguage(lang);
                languageDropdown.classList.remove('show');
            });
        });
    }

    setLanguage(lang, save = true) {
        this.currentLang = lang;

        if (save) {
            localStorage.setItem('language', lang);
        }

        // Update current language display
        const currentLangEl = document.getElementById('currentLang');
        currentLangEl.textContent = lang.toUpperCase();

        // Update all translatable elements
        this.updateContent();

        // Update active state in dropdown
        document.querySelectorAll('.language-option').forEach(option => {
            if (option.getAttribute('data-lang') === lang) {
                option.classList.add('active');
            } else {
                option.classList.remove('active');
            }
        });
    }

    updateContent() {
        const elements = document.querySelectorAll('[data-i18n]');

        elements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = translations[this.currentLang][key];

            if (translation) {
                // Check if element contains HTML
                if (translation.includes('<')) {
                    element.innerHTML = translation;
                } else {
                    element.textContent = translation;
                }
            }
        });

        // Update HTML lang attribute
        document.documentElement.lang = this.currentLang;
    }
}

// Auto-inject data-i18n attributes to elements that need translation
function injectI18nAttributes() {
    // Features section
    const featuresTitleEl = document.querySelector('#features .section-title');
    const featuresDescEl = document.querySelector('#features .section-description');
    if (featuresTitleEl && !featuresTitleEl.hasAttribute('data-i18n')) {
        featuresTitleEl.setAttribute('data-i18n', 'features-title');
    }
    if (featuresDescEl && !featuresDescEl.hasAttribute('data-i18n')) {
        featuresDescEl.setAttribute('data-i18n', 'features-description');
    }

    const featureCards = document.querySelectorAll('.feature-card');
    featureCards.forEach((card, index) => {
        const title = card.querySelector('.feature-title');
        const desc = card.querySelector('.feature-description');
        if (title && !title.hasAttribute('data-i18n')) {
            title.setAttribute('data-i18n', `feature-${index + 1}-title`);
        }
        if (desc && !desc.hasAttribute('data-i18n')) {
            desc.setAttribute('data-i18n', `feature-${index + 1}-desc`);
        }
    });

    // How it works section
    const howItWorksTitleEl = document.querySelector('#how-it-works .section-title');
    const howItWorksDescEl = document.querySelector('#how-it-works .section-description');
    if (howItWorksTitleEl && !howItWorksTitleEl.hasAttribute('data-i18n')) {
        howItWorksTitleEl.setAttribute('data-i18n', 'how-it-works-title');
    }
    if (howItWorksDescEl && !howItWorksDescEl.hasAttribute('data-i18n')) {
        howItWorksDescEl.setAttribute('data-i18n', 'how-it-works-description');
    }

    const stepCards = document.querySelectorAll('.step-card');
    stepCards.forEach((card, index) => {
        const title = card.querySelector('.step-title');
        const desc = card.querySelector('.step-description');
        if (title && !title.hasAttribute('data-i18n')) {
            title.setAttribute('data-i18n', `step-${index + 1}-title`);
        }
        if (desc && !desc.hasAttribute('data-i18n')) {
            desc.setAttribute('data-i18n', `step-${index + 1}-desc`);
        }
    });

    // Video section
    const videoTitle = document.querySelector('.video-title');
    const videoDesc = document.querySelector('.video-description');
    if (videoTitle && !videoTitle.hasAttribute('data-i18n')) {
        videoTitle.setAttribute('data-i18n', 'video-title');
    }
    if (videoDesc && !videoDesc.hasAttribute('data-i18n')) {
        videoDesc.setAttribute('data-i18n', 'video-description');
    }

    // Download section
    const downloadTitle = document.querySelector('.download-title');
    const downloadDesc = document.querySelector('.download-description');
    const downloadNote = document.querySelector('.download-note');
    if (downloadTitle && !downloadTitle.hasAttribute('data-i18n')) {
        downloadTitle.setAttribute('data-i18n', 'download-title');
    }
    if (downloadDesc && !downloadDesc.hasAttribute('data-i18n')) {
        downloadDesc.setAttribute('data-i18n', 'download-description');
    }
    if (downloadNote && !downloadNote.hasAttribute('data-i18n')) {
        downloadNote.setAttribute('data-i18n', 'download-note');
    }

    const downloadFeatures = document.querySelectorAll('.download-feature span:last-child');
    downloadFeatures.forEach((feature, index) => {
        if (!feature.hasAttribute('data-i18n')) {
            feature.setAttribute('data-i18n', `download-feature-${index + 1}`);
        }
    });

    const downloadBtn = document.querySelector('.btn-download');
    if (downloadBtn) {
        const btnText = downloadBtn.childNodes[2]; // Text node after icon
        if (btnText && btnText.nodeType === Node.TEXT_NODE) {
            const span = document.createElement('span');
            span.setAttribute('data-i18n', 'download-btn');
            span.textContent = btnText.textContent.trim();
            btnText.replaceWith(span);
        }
        const btnSubtext = downloadBtn.querySelector('.btn-subtext');
        if (btnSubtext && !btnSubtext.hasAttribute('data-i18n')) {
            btnSubtext.setAttribute('data-i18n', 'download-btn-sub');
        }
    }

    // Footer
    const footerDesc = document.querySelector('.footer-description');
    const footerCopyright = document.querySelector('.footer-copyright');
    if (footerDesc && !footerDesc.hasAttribute('data-i18n')) {
        footerDesc.setAttribute('data-i18n', 'footer-description');
    }
    if (footerCopyright && !footerCopyright.hasAttribute('data-i18n')) {
        footerCopyright.setAttribute('data-i18n', 'footer-copyright');
    }

    const footerHeadings = document.querySelectorAll('.footer-heading');
    footerHeadings.forEach((heading, index) => {
        if (!heading.hasAttribute('data-i18n')) {
            heading.setAttribute('data-i18n', index === 0 ? 'footer-product' : 'footer-support');
        }
    });

    const footerLinks = document.querySelectorAll('.footer-link');
    const footerLinkKeys = ['nav-features', 'nav-how-it-works', 'nav-download', 'footer-documentation', 'footer-report-bug', 'footer-contact'];
    footerLinks.forEach((link, index) => {
        if (!link.hasAttribute('data-i18n') && footerLinkKeys[index]) {
            link.setAttribute('data-i18n', footerLinkKeys[index]);
        }
    });
}

// Initialize when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    injectI18nAttributes();
    window.languageManager = new LanguageManager();
});
